<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>問題追加｜Study Habits</title>

<style>
body{
  margin:0;
  background:#f4f4f4;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
}
header{
  background:#b00020;
  color:white;
  text-align:center;
  padding:16px;
  font-weight:bold;
}
main{
  max-width:600px;
  margin:auto;
  padding:16px;
}
.card{
  background:white;
  padding:16px;
  border-radius:12px;
  margin-bottom:16px;
}
h2{margin-top:0;font-size:18px;}

input,textarea{
  width:100%;
  padding:12px;
  margin-top:8px;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:15px;
  box-sizing:border-box;
}

.choice{
  display:flex;
  gap:8px;
  margin-top:8px;
}
.choice input{flex:1;}

select{
  width:100%;
  padding:12px;
  margin-top:8px;
  border-radius:10px;
}

.btn{
  margin-top:12px;
  padding:12px;
  border:none;
  border-radius:10px;
  font-size:15px;
}
.primary{background:#b00020;color:white;}
.danger{background:#ccc;}

.q-item{
  padding:10px 0;
  border-bottom:1px solid #eee;
  display:flex;
  justify-content:space-between;
}
</style>
</head>

<body>

<header>問題を追加</header>

<main>

<section class="card">
<h2>新しい問題（4択）</h2>

<input id="question" placeholder="問題文">

<div id="choices">
  <input placeholder="選択肢①">
  <input placeholder="選択肢②">
  <input placeholder="選択肢③">
  <input placeholder="選択肢④">
</div>

<select id="answer">
  <option value="">正解を選択</option>
  <option value="0">選択肢①</option>
  <option value="1">選択肢②</option>
  <option value="2">選択肢③</option>
  <option value="3">選択肢④</option>
</select>

<textarea id="explain" placeholder="解説（任意）"></textarea>

<button class="btn primary" onclick="save()">保存</button>
</section>

<section class="card">
<h2>既存問題</h2>
<div id="list"></div>
</section>

</main>

<script>
function save(){
  const q=document.getElementById("question").value.trim();
  const cs=[...document.querySelectorAll("#choices input")]
    .map(i=>i.value.trim());
  const ai=document.getElementById("answer").value;

  if(!q) return alert("問題文を入力してください");
  if(cs.some(c=>!c)) return alert("選択肢は4つすべて入力してください");
  if(ai==="") return alert("正解を選択してください");

  questions.push({
    question:q,
    choices:cs,
    answer:cs[ai],
    explain:document.getElementById("explain").value||""
  });

  localStorage.setItem("questions",JSON.stringify(questions));
  location.reload();
}

function render(){
  const l=document.getElementById("list");
  l.innerHTML="";
  questions.forEach((q,i)=>{
    const d=document.createElement("div");
    d.className="q-item";
    d.innerHTML=`
      <div>${q.question}</div>
      <button class="btn danger" onclick="del(${i})">削除</button>
    `;
    l.appendChild(d);
  });
}
function del(i){
  if(!confirm("削除しますか？"))return;
  questions.splice(i,1);
  localStorage.setItem("questions",JSON.stringify(questions));
  render();
}
render();
</script>

</body>
</html>
