<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>問題追加｜Study Habits</title>

<style>
body{
  margin:0;
  background:#f4f4f4;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
}
header{
  background:#b00020;
  color:white;
  text-align:center;
  padding:16px;
  font-weight:bold;
}
main{
  max-width:600px;
  margin:auto;
  padding:16px;
}
.card{
  background:white;
  padding:16px;
  border-radius:12px;
  margin-bottom:16px;
}
h2{margin-top:0;font-size:18px;}

input,textarea{
  width:100%;
  padding:12px;
  margin-top:8px;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:15px;
  box-sizing:border-box;
}

.btn{
  margin-top:12px;
  padding:14px;
  border:none;
  border-radius:12px;
  font-size:16px;
  width:100%;
}
.primary{background:#b00020;color:white;}
.secondary{background:#eee;color:#333;}

.q-item{
  padding:10px 0;
  border-bottom:1px solid #eee;
  display:flex;
  justify-content:space-between;
}
</style>
</head>

<body>

<header>問題を追加</header>

<main>

<section class="card">
<h2>新しい問題（4択）</h2>

<input id="question" placeholder="問題文">

<div id="choices">
  <input placeholder="選択肢①（正解）">
  <input placeholder="選択肢②">
  <input placeholder="選択肢③">
  <input placeholder="選択肢④">
</div>

<textarea id="explain" placeholder="解説（任意）"></textarea>

<button class="btn primary" onclick="save()">保存</button>
</section>

<section class="card">
<h2>既存問題</h2>
<div id="list"></div>
</section>

<!-- ★ ナビゲーションボタン -->
<section class="card">
  <button class="btn primary"
    onclick="location.href='quiz.html'">
    問題を解く
  </button>

  <button class="btn secondary"
    onclick="location.href='index.html'">
    ホームに戻る
  </button>
</section>

</main>

<script>
let questions =
  JSON.parse(localStorage.getItem("questions")) || [];

function save(){
  const q = document.getElementById("question").value.trim();
  const cs = [...document.querySelectorAll("#choices input")]
    .map(i => i.value.trim());

  if(!q) return alert("問題文を入力してください");
  if(cs.some(c => !c))
    return alert("選択肢は4つすべて入力してください");

  questions.push({
    question: q,
    choices: cs,
    answer: cs[0], // 一番上が正解
    explain: document.getElementById("explain").value || ""
  });

  localStorage.setItem("questions", JSON.stringify(questions));
  location.reload();
}

function render(){
  const l = document.getElementById("list");
  l.innerHTML = "";
  questions.forEach((q,i)=>{
    const d = document.createElement("div");
    d.className = "q-item";
    d.innerHTML = `
      <div>${q.question}</div>
      <button class="btn secondary" onclick="del(${i})">
        削除
      </button>
    `;
    l.appendChild(d);
  });
}

function del(i){
  if(!confirm("削除しますか？")) return;
  questions.splice(i,1);
  localStorage.setItem("questions", JSON.stringify(questions));
  render();
}

render();
</script>

</body>
</html>
