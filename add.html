<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>問題追加</title>

<style>
body{margin:0;background:#f4f4f4;font-family:-apple-system}
main{padding:16px;max-width:600px;margin:auto}
input,textarea{width:100%;padding:8px;margin-top:8px}
button{margin-top:8px}
</style>
</head>

<body>
<main>
<h2>問題追加</h2>

<input id="q" placeholder="問題文">
<input id="a" placeholder="正解">

<div id="wrongs"></div>
<button onclick="addWrong()">不正解を追加</button>

<textarea id="exp" placeholder="解説（任意）"></textarea>

<button onclick="save()">保存</button>

<h3>既存問題</h3>
<div id="list"></div>
</main>

<script>
let wrongs=[];

function addWrong(v=""){
  const i=wrongs.length;
  wrongs.push(v);
  renderWrongs();
}
function removeWrong(i){
  wrongs.splice(i,1);
  renderWrongs();
}
function renderWrongs(){
  const d=document.getElementById("wrongs");
  d.innerHTML="";
  wrongs.forEach((w,i)=>{
    d.innerHTML+=`
      <div>
        <input value="${w}" oninput="wrongs[${i}]=this.value">
        <button onclick="removeWrong(${i})">削除</button>
      </div>`;
  });
}

function save(){
  const qs=
    JSON.parse(localStorage.getItem("questions"))||[];
  qs.push({
    question:q.value,
    answer:a.value,
    choices:[a.value,...wrongs],
    explanation:exp.value||""
  });
  localStorage.setItem("questions",JSON.stringify(qs));
  location.reload();
}

function renderList(){
  const qs=
    JSON.parse(localStorage.getItem("questions"))||[];
  const d=document.getElementById("list");
  d.innerHTML="";
  qs.forEach((x,i)=>{
    d.innerHTML+=`
      <div>
        ${x.question}
        <button onclick="del(${i})">削除</button>
      </div>`;
  });
}
function del(i){
  const qs=
    JSON.parse(localStorage.getItem("questions"))||[];
  qs.splice(i,1);
  localStorage.setItem("questions",JSON.stringify(qs));
  renderList();
}

renderList();
addWrong();
</script>
</body>
</html>
