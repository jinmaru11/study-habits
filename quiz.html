<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>問題に挑戦｜Study Habits</title>

<style>
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  background: #f4f4f4;
}
header {
  background: #b00020;
  color: white;
  text-align: center;
  padding: 16px;
}
main {
  max-width: 600px;
  margin: auto;
  padding: 16px;
}
.card {
  background: white;
  padding: 16px;
  border-radius: 12px;
}
.choice {
  margin-top: 10px;
  padding: 14px;
  border-radius: 10px;
  border: none;
  background: #eee;
  width: 100%;
}
.correct { background:#b00020; color:white; }
.wrong { background:#ccc; }
</style>
</head>

<body>

<header>
  問題に挑戦
  <div id="progress"></div>
</header>

<main>
  <div class="card">
    <div id="q"></div>
    <div id="c"></div>
  </div>
  <button onclick="next()">次へ</button>
</main>

<script>
const qs =
  JSON.parse(localStorage.getItem("questions")) || [];

let i = 0;
let done = false;

function show() {
  done = false;
  document.getElementById("q").textContent = qs[i].question;
  document.getElementById("progress").textContent =
    `${i+1} / ${qs.length}`;

  const c = document.getElementById("c");
  c.innerHTML = "";

  qs[i].choices.forEach(x => {
    const b = document.createElement("button");
    b.className = "choice";
    b.textContent = x;
    b.onclick = () => answer(b, x);
    c.appendChild(b);
  });
}

function answer(btn, x) {
  if (done) return;
  done = true;

  document.querySelectorAll(".choice").forEach(b => {
    if (b.textContent === qs[i].answer)
      b.classList.add("correct");
    else if (b === btn)
      b.classList.add("wrong");
    b.disabled = true;
  });
}

function next() {
  if (!done) return alert("回答してください");
  i++;
  if (i >= qs.length) {
    alert("完了！");
    location.href = "index.html";
  } else show();
}

show();
</script>

</body>
</html>
