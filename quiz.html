<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>問題に挑戦｜Study Habits</title>

<style>
body{
  margin:0;
  background:#f4f4f4;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
}
header{
  background:#b00020;
  color:white;
  padding:16px;
  text-align:center;
  font-weight:bold;
}
main{
  max-width:600px;
  margin:auto;
  padding:16px;
}
.card{
  background:white;
  padding:16px;
  border-radius:12px;
}
.choice{
  width:100%;
  padding:14px;
  margin-top:10px;
  border:none;
  border-radius:10px;
  font-size:16px;
  background:#eee;
}
.correct{ background:#b00020; color:white; }
.wrong{ background:#ccc; color:#333; }

button.next{
  margin-top:16px;
  width:100%;
  padding:16px;
  border:none;
  border-radius:12px;
  font-size:18px;
  background:#b00020;
  color:white;
}

/* ===== 偉人カード演出 ===== */
.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.6);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:999;
}
.hero{
  padding:24px;
  border-radius:16px;
  text-align:center;
  animation:flip 1s;
}
.hero.common{ background:#e0e0e0; }
.hero.rare{ background:#8ecae6; }
.hero.legendary{
  background:linear-gradient(135deg,#ffd700,#fff5b7,#ffd700);
  box-shadow:0 0 20px rgba(255,215,0,0.8);
}
.hero h2{ margin:0; }
.hero p{ margin:6px 0 0; font-size:14px; }

@keyframes flip{
  from{ transform:rotateY(90deg); opacity:0 }
  to{ transform:rotateY(0); opacity:1 }
}
</style>
</head>

<body>

<header>
  問題に挑戦
  <div id="progress" style="font-size:14px;margin-top:4px;"></div>
</header>

<main>
  <div class="card">
    <div id="q" style="font-size:18px;font-weight:bold;"></div>
    <div id="choices"></div>
  </div>
  <button class="next" onclick="next()">次へ</button>
</main>

<script>
  alert("QUIZ: " + localStorage.getItem("questions"));
/* ===== 問題 ===== */
const questions =
  JSON.parse(localStorage.getItem("questions")) || [];

if(questions.length===0){
  alert("問題がありません");
  location.href="index.html";
}

let i=0;
let answered=false;

/* ===== シャッフル ===== */
function shuffle(arr){
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr
